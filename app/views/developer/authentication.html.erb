<ul class="breadcrumb">
  <li>
    <a href="/developer">Developer documentation</a> 
    <span class="divider">/</span>
  </li>
  <li class="active">
    <a href="/developer/authentication">Authentication guide</a>
  </li>
</ul>

<h1>Authentication Guide</h1>

<p>
  FootballOps.org uses <%= link_to 'OAuth 2', 'http://oauth.net/2' %> for all
  authentication processes.<br />
  <em><strong>*Note:</strong> Before you can begin using the FootballOps.org API,
  you must <%= link_to 'register your app', new_developer_app_path %>.</em>
</p>

<p>
  After registering your app with FootballOps.org, you'll need to perform the following
  steps in order to make authenticated requests on behalf of your users:
</p>

<ol>
  <li><%= link_to 'Ask the user to allow your application access', '#authorization' %></li>
  <li><%= link_to 'Convert the authorization code into an access token', '#token' %></li>
  <li><%= link_to 'Supply the access token when making API requests', '#request' %></li>
</ol>


<div id="authorization" class="api-method"></div>
<h2>Authorization</h2>
<p>
  All users must agree to allow your application access to make requests on their behalf.
  To facilitate this, provide a link (or redirect) in your app to the following URI:
</p>

<pre class="pizzazz"><%= @api_base_uri %>/oauth/authorize</pre>

<p>There are also some query params that you should include in your link:</p>

<h3>Query Parameters</h3>
<table class="table params">
  <tbody>
    <tr>
      <td>
        <div class="param">client_id</div>
        <span>Required</span>
      </td>
      <td>
        This is your client_id that was givin to you after you registered your app.
      </td>
    </tr>
    <tr>
      <td>
        <div class="param">redirect_uri</div>
        <span>Optional</span>
      </td>
      <td>
        This optional param can tell FootballOps.org where to redirect to after
        authorizing your application. If you do not supply this param, we will
        use the redirect URI that you entered when registering your app.
      </td>
    </tr>
    <tr>
      <td>
        <div class="param">state</div>
        <span>Optional</span>
      </td>
      <td>
        This is an optional param that will be returned with the redirect back to
        your app (your redirect URI). This can be anything you want, and is typically
        used to identify the user within your own app.<br />
        <em>Note: This value will be truncated to 255 characters</em>
      </td>
    </tr>
  </tbody>
</table>

<p>
  If the user authorizes your application to access their data, FootballOps.org
  will then redirect to your <code>redirect_uri</code> with the following params:
</p>

<h3>Response Parameters</h3>
<table class="table params">
  <tbody>
    <tr>
      <td><div class="param">code</div></td>
      <td>
        An authorization code that you can <%= link_to 'convert into an access token', '#token' %>.
      </td>
    </tr>
    <tr>
      <td><div class="param">state</div></td>
      <td>This is truncated value that you passed in the original request.</td>
    </tr>
  </tbody>
</table>


<div id="token" class="api-method">
  <h2>Converting an authorization code into an Access Token</h2>
</div>
<p>
  Once you've obtained an <code>authorization_code</code>, you can use that to request an
  <code>access_token</code>. To do so, you only need to make a <code>POST</code> request to:
  <code><%= @api_uri %>/oauth/token</code>
</p>

<p>
  Please note that you need to use basic HTTP authentication for this request with your provided
  Client ID and Client Secret. Also note that authorization codes expire one hour after
  creation.
</p>

<h3>Example Request</h3>
<pre class="pizzazz">
<strong>curl</strong> -i <span class="string">"<%= @api_base_uri %>/oauth/token"</span> \
  -u <span class="string">"YOUR_CLIENT_ID:YOUR_CLIENT_SECRET"</span> \
  -X POST -d <span class="string">"grant_type=authorization_code"</span> \
  -d <span class="string">"code=YOUR_AUTHORIZATION_CODE"</span>
</pre>

<h3>Example Response</h3>
<pre class="pizzazz">
<span class="headers">HTTP/1.1 200 OK
Content-Type: application/json; charset=utf-8</span>

<%= Pizzazz.ify(@access_token).html_safe %></pre>


<div id="request" class="api-method">
  <h2>Making authenticated requests</h2>
</div>

<p>
  To make authenticated requests on behalf of your user, simply include your
  <code>access_token</code> in an authorization header with any request.
</p>

<h3>Example Request</h3>
<pre class="pizzazz">
<strong>curl</strong> -i <span class="string">"<%= @api_base_uri + @api_versioned_uri %>/users"</span> \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
</pre>
